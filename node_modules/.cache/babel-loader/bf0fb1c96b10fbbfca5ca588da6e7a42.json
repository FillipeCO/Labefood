{"ast":null,"code":"var _jsxFileName = \"/home/fillipecorreia/Desktop/LabeFood/Vaughan-labe-food5/src/pages/cartpage/CartPage.js\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport { BASE_URL } from \"../../constants/urls\";\nimport { useEffect, useState, useContext, createContext } from \"react\";\nimport Footer from \"../../components/Footer/Footer\";\nimport Header from \"../../components/Header/Header\";\nimport { useNavigate } from \"react-router-dom\";\nimport { AddressContainer, RestaurantContainer, AdressContainer, CartContainer, ShippingText, SubtotalPrice, ButtonContainer, PaymentContainer, PlaceholderCtn } from \"./styled\";\nimport { getProfile, getDetailRestaurant, sendOrder } from \"../../axiosRequests/user\";\nimport { GlobalStateContext } from \"../../components/Global/GlobalStateContext\";\nimport { FormControl, FormControlLabel, Radio, RadioGroup } from \"@material-ui/core\";\nimport CardFood from \"../../components/CardFood/CardFood\";\nimport { Button, Checkbox } from \"@material-ui/core\";\nimport { RestaurantMenu } from \"@material-ui/icons\";\nimport { useRequestData } from \"../../hooks/useRequestData\";\nimport CardFoodInCart from \"../../components/CardFoodInCart/CardFoodInCart\";\nimport cartEmpty from '../../assets/empty-cart.png';\n\nconst CartPage = () => {\n  const [address, setAddress] = useState({});\n  const {\n    states,\n    sets\n  } = useContext(GlobalStateContext);\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [product, setProduct] = useState([]);\n  const [payment, setPayment] = useState(\"\");\n  const [shipping, setShipping] = useState([]);\n  const navigate = useNavigate();\n  const [restaurant, setRestaurant] = useState([]);\n  const [restaurantDetails, isLoadingRestaurantDetails, errorRestaurantDetails] = useRequestData(`${BASE_URL}/restaurants/${states.restaurantId}`);\n  useEffect(() => {\n    getProfile(setAddress);\n    getDetailRestaurant(states.cart.idRestaurant, setRestaurant);\n  }, []);\n  const renderAddress = address.address ? /*#__PURE__*/React.createElement(AddressContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }, \"Endere\\xE7o de entrega:\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }\n  }, address.address)) : /*#__PURE__*/React.createElement(AdressContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }\n  }, \"Favor cadastrar um endere\\xE7oclicando\", \" \", /*#__PURE__*/React.createElement(\"strong\", {\n    onClick: () => navigate(\"/endereco\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }\n  }, \"aqui.\")));\n  const listProductsInCart = states.cart && states.cart.map(product => {\n    const toRemove = () => {\n      const updateProductsInCart = states.cart && states.cart.map(item => {\n        if (item.id === product.id) {\n          //  return item.quantity = item.quantity -1\n          return { ...item,\n            quantity: item.quantity - 1\n          };\n        }\n\n        return item;\n      }).filter(item => {\n        return item.quantity > 0;\n      });\n      sets.setCart(updateProductsInCart);\n      console.log(\"REMOVI\", states.cart);\n    };\n\n    return /*#__PURE__*/React.createElement(CardFoodInCart, {\n      product: product,\n      key: product.id,\n      senQuantity: product.quantity,\n      onClickRemove: toRemove,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }\n    });\n  });\n  const cartId = states.cart && states.cart.map(product => {\n    return product.id;\n  });\n  const cartQuantity = states.cart && states.cart.map(product => {\n    return product.quantity;\n  });\n  const axiosBody = {\n    \"products\": [{\n      \"id\": cartId,\n      \"quantity\": cartQuantity\n    }],\n    \"paymentMethod\": payment\n  };\n\n  const sendOrder = () => {\n    const body = axiosBody;\n    const headers = {\n      headers: {\n        auth: localStorage.getItem(\"token\")\n      }\n    };\n    axios.post(`${BASE_URL}/restaurants/${states.restaurantId}/order`, body, headers).then(res => {\n      alert(\"Pedido enviado com sucesso!\");\n      console.log(res.data);\n      clear();\n    }).catch(error => {\n      alert(\"Pedido deu erro\");\n      console.log(error.response);\n    });\n  };\n\n  return console.log(\"CARRINHO\", states.cart), console.log(\"RESTAURANTE\", restaurant), console.log(body), console.log(\"ID DO CARRINHO\", cartId), console.log(\"QUANTIDADE\", cartQuantity), console.log(\"ID DO RESTAURANTE\", states.restaurantId), /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }, renderAddress, restaurantDetails && restaurantDetails.restaurant && /*#__PURE__*/React.createElement(RestaurantContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  }, restaurantDetails.restaurant.name), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }\n  }, restaurantDetails.restaurant.address), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 9\n    }\n  }, restaurantDetails.restaurant.deliveryTime)), states.cart && states.cart.length > 0 ? listProductsInCart : /*#__PURE__*/React.createElement(PlaceholderCtn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 68\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 9\n    }\n  }, \"O seu carrinho est\\xE1 vazio\"), /*#__PURE__*/React.createElement(\"img\", {\n    src: cartEmpty,\n    alt: \"Carrinho vazio\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 9\n    }\n  })), restaurantDetails && restaurantDetails.restaurant && /*#__PURE__*/React.createElement(ShippingText, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }, \"Frete: R$\", restaurantDetails.restaurant.shipping)), restaurantDetails && restaurantDetails.restaurant && states.cart && states.cart.length > 0 && /*#__PURE__*/React.createElement(SubtotalPrice, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, \"Subtotal: R$\", states.cart.reduce((acc, item) => {\n    return acc + item.price * item.quantity + Number(`${restaurantDetails.restaurant.shipping}`);\n  }, 0))), states.cart && states.cart.length > 0 && /*#__PURE__*/React.createElement(PaymentContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  }, \"Forma de pagamento\"), /*#__PURE__*/React.createElement(FormControl, {\n    component: \"fieldset\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(RadioGroup, {\n    \"aria-label\": \"payment\",\n    name: \"payment\",\n    value: payment,\n    onChange: e => setPayment(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(FormControlLabel, {\n    value: \"money\",\n    control: /*#__PURE__*/React.createElement(Radio, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 28\n      }\n    }),\n    label: \"Dinheiro\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    value: \"creditcard\",\n    control: /*#__PURE__*/React.createElement(Radio, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 28\n      }\n    }),\n    label: \"Cart\\xE3o\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 17\n    }\n  })))), states.cart && states.cart.length > 0 && /*#__PURE__*/React.createElement(ButtonContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    fullWidth: true,\n    style: {\n      margin: \"10px\"\n    },\n    onClick: () => {\n      sendOrder(states.restaurantId, body);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }\n  }, \"Confirmar\"))), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 9\n    }\n  }));\n};\n\nexport default CartPage;","map":{"version":3,"sources":["/home/fillipecorreia/Desktop/LabeFood/Vaughan-labe-food5/src/pages/cartpage/CartPage.js"],"names":["React","axios","BASE_URL","useEffect","useState","useContext","createContext","Footer","Header","useNavigate","AddressContainer","RestaurantContainer","AdressContainer","CartContainer","ShippingText","SubtotalPrice","ButtonContainer","PaymentContainer","PlaceholderCtn","getProfile","getDetailRestaurant","sendOrder","GlobalStateContext","FormControl","FormControlLabel","Radio","RadioGroup","CardFood","Button","Checkbox","RestaurantMenu","useRequestData","CardFoodInCart","cartEmpty","CartPage","address","setAddress","states","sets","totalPrice","setTotalPrice","product","setProduct","payment","setPayment","shipping","setShipping","navigate","restaurant","setRestaurant","restaurantDetails","isLoadingRestaurantDetails","errorRestaurantDetails","restaurantId","cart","idRestaurant","renderAddress","listProductsInCart","map","toRemove","updateProductsInCart","item","id","quantity","filter","setCart","console","log","cartId","cartQuantity","axiosBody","body","headers","auth","localStorage","getItem","post","then","res","alert","data","clear","catch","error","response","name","deliveryTime","length","reduce","acc","price","Number","e","target","value","margin"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport { BASE_URL } from \"../../constants/urls\";\nimport { useEffect, useState, useContext, createContext } from \"react\";\nimport Footer from \"../../components/Footer/Footer\";\nimport Header from \"../../components/Header/Header\";\nimport { useNavigate } from \"react-router-dom\";\nimport {\n  AddressContainer,\n  RestaurantContainer,\n  AdressContainer,\n  CartContainer,\n  ShippingText,\n  SubtotalPrice,\n  ButtonContainer,\n  PaymentContainer,\n  PlaceholderCtn,\n} from \"./styled\";\nimport { getProfile, getDetailRestaurant, sendOrder } from \"../../axiosRequests/user\";\nimport { GlobalStateContext } from \"../../components/Global/GlobalStateContext\";\nimport {\n  FormControl,\n  FormControlLabel,\n  Radio,\n  RadioGroup,\n} from \"@material-ui/core\";\nimport CardFood from \"../../components/CardFood/CardFood\";\nimport { Button, Checkbox } from \"@material-ui/core\";\nimport { RestaurantMenu } from \"@material-ui/icons\";\nimport { useRequestData } from \"../../hooks/useRequestData\";\nimport CardFoodInCart from \"../../components/CardFoodInCart/CardFoodInCart\";\nimport cartEmpty  from '../../assets/empty-cart.png'\n\nconst CartPage = () => {\n  const [address, setAddress] = useState({});\n  const { states, sets } = useContext(GlobalStateContext);\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [product, setProduct] = useState([]);\n  const [payment, setPayment] = useState(\"\");\n  const [shipping, setShipping] = useState([]);\n  const navigate = useNavigate();\n  const [restaurant, setRestaurant] = useState([]);\n  const [\n    restaurantDetails,\n    isLoadingRestaurantDetails,\n    errorRestaurantDetails,\n  ] = useRequestData(`${BASE_URL}/restaurants/${states.restaurantId}`);\n\n \n  useEffect(() => {\n    getProfile(setAddress);\n    getDetailRestaurant(states.cart.idRestaurant, setRestaurant);\n  }, []);\n\n  const renderAddress = address.address ? (\n    <AddressContainer>\n      <p>Endereço de entrega:</p>\n      <span>{address.address}</span>\n    </AddressContainer>\n  ) : (\n    <AdressContainer>\n      <p>\n        Favor cadastrar um endereçoclicando{\" \"}\n        <strong onClick={() => navigate(\"/endereco\")}>aqui.</strong>\n      </p>\n    </AdressContainer>\n  );\n\n\nconst listProductsInCart = states.cart && states.cart.map((product) => {\n\n\n    const toRemove = () => {\n        const updateProductsInCart =\n          states.cart &&\n          states.cart\n            .map((item) => {\n              if (item.id === product.id) {\n                //  return item.quantity = item.quantity -1\n                return {\n                  ...item,\n                  quantity: item.quantity - 1,\n                };\n              }\n              return item;\n            })\n            .filter((item) => {\n              return item.quantity > 0;\n            });\n\n        sets.setCart(updateProductsInCart);\n\n        console.log(\"REMOVI\", states.cart);\n      };\n\n    return(\n        <CardFoodInCart\n          product={product}\n          key={product.id}\n         senQuantity={product.quantity}\n          onClickRemove={toRemove}\n          \n          />\n    )\n})\n\nconst cartId = states.cart && states.cart.map((product) => {\n  return product.id;\n});\n\nconst cartQuantity = states.cart && states.cart.map((product) => {\n  return product.quantity;\n});\n\nconst axiosBody = {\n  \"products\": [{\n    \"id\": cartId,\n    \"quantity\": cartQuantity\n  }],\n  \"paymentMethod\": payment,\n}\n\nconst sendOrder = () => {\n  const body = axiosBody;\n  const headers = {\n    headers: {\n      auth: localStorage.getItem(\"token\")\n    }\n  }\n\n  axios\n    .post(`${BASE_URL}/restaurants/${states.restaurantId}/order`, body, headers)\n    .then((res) => {\n      alert(\"Pedido enviado com sucesso!\");\n      console.log(res.data);\n      clear();\n    })\n    .catch((error) => {\n      alert(\"Pedido deu erro\");\n      console.log(error.response);\n    })\n}\n\n\n\n  return (\n    console.log(\"CARRINHO\", states.cart),\n    console.log(\"RESTAURANTE\", restaurant),\n    console.log(body),\n    console.log(\"ID DO CARRINHO\", cartId),\n    console.log(\"QUANTIDADE\", cartQuantity),\n    console.log(\"ID DO RESTAURANTE\", states.restaurantId),\n    (\n      <>\n        <Header />\n        <CartContainer>\n          {renderAddress}\n\n          {restaurantDetails && restaurantDetails.restaurant && (\n          <RestaurantContainer>\n        <p>{restaurantDetails.restaurant.name}</p>\n        <span>{restaurantDetails.restaurant.address}</span>\n        <span>{restaurantDetails.restaurant.deliveryTime}</span>\n    </RestaurantContainer>)}\n\n    {states.cart && states.cart.length > 0 ?  listProductsInCart : <PlaceholderCtn>\n        <h3>O seu carrinho está vazio</h3>\n        <img src={cartEmpty} alt=\"Carrinho vazio\"/>\n        </PlaceholderCtn>}\n\n          \n          {restaurantDetails && restaurantDetails.restaurant && (\n          <ShippingText>\n            <p>Frete: R${restaurantDetails.restaurant.shipping}</p>\n          </ShippingText>\n          )}\n\n\n          {restaurantDetails && restaurantDetails.restaurant && states.cart && states.cart.length > 0 && (\n          <SubtotalPrice>\n            <span>Subtotal: R${states.cart.reduce((acc, item) => {\n              return acc + item.price * item.quantity + Number(`${restaurantDetails.restaurant.shipping}`);\n            }, 0)}</span>\n          </SubtotalPrice>\n          )}\n\n          {states.cart && states.cart.length > 0 && (\n          <PaymentContainer>\n            <p>Forma de pagamento</p>\n            <FormControl component=\"fieldset\">\n              <RadioGroup\n                aria-label=\"payment\"\n                name=\"payment\"\n                value={payment}\n                onChange={(e) => setPayment(e.target.value)}\n              >\n                <FormControlLabel\n                  value=\"money\"\n                  control={<Radio />}\n                  label=\"Dinheiro\"\n                />\n                <FormControlLabel\n                  value=\"creditcard\"\n                  control={<Radio />}\n                  label=\"Cartão\"\n                />\n              </RadioGroup>\n            </FormControl>\n          </PaymentContainer>\n          )}\n\n          {states.cart && states.cart.length > 0 && (\n          <ButtonContainer>\n            <Button\n            \n              variant=\"contained\"\n              color=\"primary\"\n              fullWidth\n              style={{ margin: \"10px\" }}\n              onClick={() => { sendOrder(states.restaurantId, body )}}\n                \n            >\n              Confirmar\n            </Button>\n          </ButtonContainer>\n          )}\n\n\n        </CartContainer>\n        <Footer />\n      </>\n    )\n  );\n};\n\nexport default CartPage;\n"]},"metadata":{},"sourceType":"module"}